var Change,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e])};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();!function(n){n[n.Added=0]="Added",n[n.Removed=1]="Removed",n[n.Captured=2]="Captured",n[n.Died=3]="Died"}(Change||(Change={}));var Player=function(){return function(n){this.names={b:"Yellow",r:"Green",g:"Blue",d:"Dead",w:"Red"},this.name=this.names[n.charAt(0)]}}(),Vector=function(){return function(n,t){this.dx=n,this.dy=t}}(),Radius=function(){function n(n){this.counter=0,this.max=n}return n.prototype.next=function(){return void 0===this.max||void 0!==this.max&&this.counter<this.max?(this.counter++,{value:this.counter,done:!1}):{value:null,done:!0}},n}(),Piece=function(){return function(n){this.names={R:"Rook",P:"Pawn",K:"King",Q:"Queen",B:"Bishop",N:"Knight"},this.radius={Rook:new Radius,Pawn:new Radius(2),King:new Radius(1),Queen:new Radius,Bishop:new Radius,Knight:new Radius(1)},this.jump={Rook:!1,Pawn:!1,King:!1,Queen:!1,Bishop:!1,Knight:!0},this.mobility={Rook:[new Vector(function(n,t){return n+t},function(n){return n}),new Vector(function(n,t){return n-t},function(n){return n}),new Vector(function(n){return n},function(n,t){return n+t}),new Vector(function(n){return n},function(n,t){return n-t})],Pawn:[new Vector(function(n){return n},function(n,t){return n+t})],King:[new Vector(function(n){return n+1},function(n){return n}),new Vector(function(n){return n-1},function(n){return n}),new Vector(function(n){return n},function(n){return n+1}),new Vector(function(n){return n},function(n){return n-1}),new Vector(function(n){return n+1},function(n){return n+1}),new Vector(function(n){return n+1},function(n){return n-1}),new Vector(function(n){return n-1},function(n){return n+1}),new Vector(function(n){return n-1},function(n){return n-1})],Queen:[new Vector(function(n,t){return n+t},function(n){return n}),new Vector(function(n,t){return n-t},function(n){return n}),new Vector(function(n){return n},function(n,t){return n+t}),new Vector(function(n){return n},function(n,t){return n-t}),new Vector(function(n,t){return n+t},function(n,t){return n+t}),new Vector(function(n,t){return n+t},function(n,t){return n-t}),new Vector(function(n,t){return n-t},function(n,t){return n+t}),new Vector(function(n,t){return n-t},function(n,t){return n-t})],Bishop:[new Vector(function(n,t){return n+t},function(n,t){return n+t}),new Vector(function(n,t){return n+t},function(n,t){return n-t}),new Vector(function(n,t){return n-t},function(n,t){return n+t}),new Vector(function(n,t){return n-t},function(n,t){return n-t})],Knight:[new Vector(function(n){return n+2},function(n){return n+1}),new Vector(function(n){return n+2},function(n){return n-1}),new Vector(function(n){return n-2},function(n){return n+1}),new Vector(function(n){return n-2},function(n){return n-1}),new Vector(function(n){return n+1},function(n){return n+2}),new Vector(function(n){return n+1},function(n){return n-2}),new Vector(function(n){return n-1},function(n){return n+2}),new Vector(function(n){return n-1},function(n){return n-2})]},this.name=this.names[n.charAt(1)],this.player=new Player(n),this.dp=n}}(),Square=function(){function n(n,t){this.code=this.convert(n,t),this.m=n,this.n=t}return n.prototype.convert=function(n,t){return""+String.fromCharCode(t+97)+(n+1)},n}(),Board=function(){return function(){this.squares=[];for(var n=0;n<14;n++){this.squares[n]=[];for(var t=0;t<14;t++)this.squares[n][t]=new Square(n,t)}}}(),Turn=function(){return function(n){this.datetime=n,this.board=new Board}}(),Variance=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.additions=0,t.captures=0,t.removals=0,t.deaths=0,t}return __extends(t,n),t}(Turn),Factory=function(){function n(){this.turns=[],this.corrections=[],this.variances=[]}return n.prototype.turn=function(n){for(var t=0,e=this.turns;t<e.length;t++){var r=e[t];if(r.datetime===n)return r}return null},n.prototype.variance=function(n){for(var t=0,e=this.variances;t<e.length;t++){var r=e[t];if(r.datetime===n)return r}return null},n.prototype.map=function(n){switch(n){case Change.Added:return"+";case Change.Removed:return"-";case Change.Captured:return"*";case Change.Died:return"x";default:return" "}},n.prototype.process=function(n){for(var t=0,e=n;t<e.length;t++){var r=e[t];if("childList"===r.mutation.type&&r.mutation.target.attributes["data-square"]){var u=this.turn(r.datetime);null==u&&(u=new Turn(r.datetime),this.turns.push(u));var o=r.mutation.target.attributes["data-square"].value;if(1===r.mutation.addedNodes.length)for(var i=r.mutation.addedNodes[0].attributes["data-piece"].value,c=0;c<14;c++)for(var a=0;a<14;a++)u.board.squares[c][a].code===o&&(u.board.squares[c][a].piece=new Piece(i))}}return this},n.prototype.analyse=function(){if(this.turns.length>1)for(var n=1;n<this.turns.length;n++){for(var t=new Variance(this.turns[n].datetime),e=0;e<14;e++)for(var r=0;r<14;r++){var u=this.turns[n].board.squares[e][r],o=this.turns[n-1].board.squares[e][r];void 0===o.piece&&void 0!==u.piece&&(t.board.squares[e][r].piece=u.piece,t.board.squares[e][r].change=Change.Added,t.additions++),void 0!==o.piece&&void 0===u.piece&&(t.board.squares[e][r].piece=o.piece,t.board.squares[e][r].change=Change.Removed,t.removals++),void 0!==o.piece&&void 0!==u.piece&&o.piece.dp!==u.piece.dp&&(t.board.squares[e][r].piece=u.piece,"Dead"===u.piece.player.name?(t.board.squares[e][r].change=Change.Died,t.deaths++):(t.board.squares[e][r].change=Change.Captured,t.captures++))}this.variances.push(t)}return this},n.prototype.correct=function(){for(var n=0;n<14;n++)for(var t=0;t<14;t++);return this},n.prototype.apply=function(){return this},n.prototype.header=function(n,t){return"When: "+n.datetime+"                         Additions: "+t.additions+"     Removals: "+t.removals+"     Captures: "+t.captures+"     Deaths: "+t.deaths},n.prototype.show=function(n){for(var t=1;t<Math.min(this.turns.length,n);t++){var e=this.turns[t],r=this.variance(e.datetime);console.log(this.header(e,r));for(var u=0;u<14;u++){for(var o="[ ",i=0;i<14;i++){void 0===(c=e.board.squares[u][i]).piece?o+="[]":o+=c.piece.dp,o+=" "}o+="]  |  [ ";for(i=0;i<14;i++){var c;void 0===(c=r.board.squares[u][i]).piece?o+="[ ]":(o+=c.piece.dp,o+=this.map(c.change)),o+=" "}o+="]",console.log(o)}console.log("")}return this},n}();