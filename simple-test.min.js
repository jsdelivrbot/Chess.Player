var Player=function(){function t(t){this.map={b:"Yellow",r:"Green",g:"Blue",d:"Dead",w:"Red"},this.name=this.map[t.charAt(0)]}return t.prototype.equals=function(t){return void 0!==t&&this.name===t.name},t}(),Piece=function(){function t(t){this.map={R:"Rook",P:"Pawn",K:"King",Q:"Queen",B:"Bishop",N:"Knight"},this.name=this.map[t.charAt(1)],this.player=new Player(t),this.dp=t}return t.prototype.equals=function(t){return void 0!==t&&(this.name===t.name&&this.player.equals(t.player))},t}(),Square=function(){function t(t,e){this.code=this.convert(t,e),this.m=t,this.n=e}return t.prototype.convert=function(t,e){return""+String.fromCharCode(e+97)+(t+1)},t}(),Board=function(){return function(){this.squares=[];for(var t=0;t<14;t++){this.squares[t]=[];for(var e=0;e<14;e++)this.squares[t][e]=new Square(t,e)}}}(),Turn=function(){return function(t){this.removed=new Board,this.added=new Board,this.datetime=t}}(),Change=function(){return function(t,e){this.from=t,this.to=e}}(),Factory=function(){function t(){this.turns=[],this.changes=[]}return t.prototype.turn=function(t){for(var e=0,r=this.turns;e<r.length;e++){var n=r[e];if(n.datetime===t)return n}return null},t.prototype.process=function(t){for(var e=0,r=t;e<r.length;e++){var n=r[e];if("childList"===n.mutation.type&&n.mutation.target.attributes["data-square"]){var i=this.turn(n.datetime);null==i&&(i=new Turn(n.datetime),this.turns.push(i));var a=n.mutation.target.attributes["data-square"].value;if(1===n.mutation.addedNodes.length)for(var o=n.mutation.addedNodes[0].attributes["data-piece"].value,s=0;s<14;s++)for(var u=0;u<14;u++)i.added.squares[s][u].code===a&&(i.added.squares[s][u].piece=new Piece(o));if(1===n.mutation.removedNodes.length){var d=n.mutation.removedNodes[0].attributes["data-piece"].value;for(s=0;s<14;s++)for(u=0;u<14;u++)i.removed.squares[s][u].code===a&&(i.removed.squares[s][u].piece=new Piece(d))}}}return this},t.prototype.analyse=function(){if(this.turns.length>2)for(var t=1;t<this.turns.length;t++)for(var e=0;e<14;e++)for(var r=0;r<14;r++){var n=this.turns[t].added.squares[e][r],i=this.turns[t-1].added.squares[e][r];void 0!==n.piece&&(n.piece.equals(i.piece)||this.changes.push(new Change(n,i)))}return this},t.prototype.show=function(t){for(var e=1;e<Math.min(this.turns.length,t);e++){console.log("When: "+this.turns[e].datetime);for(var r=0;r<14;r++){for(var n="[ ",i=0;i<14;i++){void 0===(a=this.turns[e].added.squares[r][i]).piece?n+="[]":n+=a.piece.dp,n+=" "}n+="] | [ ";for(i=0;i<14;i++){var a;void 0===(a=this.turns[e].removed.squares[r][i]).piece?n+="[]":n+=a.piece.dp,n+=" "}n+="]",console.log(n)}console.log("")}return this},t}();